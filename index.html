<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>da Linda | Luxury Hair Salon</title>
    
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#1a1a1a">
    <meta name="description" content="da Linda - Modern Luxury Hair Salon">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&family=Playfair+Display:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        :root { --color-gold: #D4AF37; --color-dark: #1a1a1a; --color-cream: #f9f9f7; }
        body { font-family: 'Lato', sans-serif; background-color: var(--color-cream); color: var(--color-dark); }
        h1, h2, h3, h4, h5, h6 { font-family: 'Playfair Display', serif; }
        html { scroll-behavior: smooth; }
        .admin-input { background: rgba(255, 255, 255, 0.9); border: 1px dashed var(--color-gold); padding: 2px 5px; border-radius: 4px; width: 100%; color: black; }
        
        /* Calendar Styles */
        .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 4px; }
        .calendar-day { aspect-ratio: 1; display: flex; align-items: center; justify-content: center; border-radius: 4px; cursor: pointer; transition: 0.2s; position: relative; }
        .calendar-day:hover:not(.empty):not(.blocked) { background-color: #e5e7eb; }
        .calendar-day.selected { background-color: var(--color-gold); color: white; font-weight: bold; }
        .calendar-day.empty { background: transparent; cursor: default; }
        
        /* Blocked Date Style */
        .calendar-day.blocked { background-color: #f3f4f6; color: #d1d5db; text-decoration: line-through; cursor: not-allowed; }
        .calendar-day.blocked.admin-view { cursor: pointer; border: 1px dashed red; } /* Admin can still click blocked dates */

        /* Carousel Styles */
        .carousel-track { transition: transform 0.5s ease-in-out; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- CONFIGURATION ---
        const CLOUD_CONFIG = {
            BIN_ID: "6957232d43b1c97be9136a94", // <--- YOUR BIN ID
            API_URL: "https://api.jsonbin.io/v3/b"
        };

        // --- ICONS ---
        const Icons = {
            Phone: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path></svg>,
            Message: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path></svg>,
            Menu: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/></svg>,
            X: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>,
            Cloud: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M17.5 19c0-3.037-2.463-5.5-5.5-5.5S6.5 15.963 6.5 19"/><path d="M12 13.5V5"/><path d="m8 9 4-4 4 4"/></svg>,
            ChevronLeft: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m15 18-6-6 6-6"/></svg>,
            ChevronRight: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m9 18 6-6-6-6"/></svg>,
            Plus: () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M5 12h14"/><path d="M12 5v14"/></svg>,
            Trash: () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/></svg>,
            Edit: () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></svg>,
            Lock: () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect width="18" height="11" x="3" y="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>
        };

        // --- DEFAULTS ---
        const DEFAULT_SERVICES = [
            {
                category: "Cuts & Styling",
                items: [
                    { name: "Women's Haircut", price: "$85+", desc: "Wash, scalp massage, blowout." },
                    { name: "Men's Haircut", price: "$55+", desc: "Precision cutting & styling." },
                    { name: "Blowout & Style", price: "$50+", desc: "Voluminous, sleek, or wavy." }
                ]
            },
            {
                category: "Color & Highlights",
                items: [
                    { name: "Full Balayage", price: "$220+", desc: "Hand-painted natural gradient." },
                    { name: "Root Touch-Up", price: "$95+", desc: "Grey coverage maintenance." },
                    { name: "Full Highlights", price: "$185+", desc: "Dimensional blonde or bronde." }
                ]
            },
            {
                category: "Treatments",
                items: [
                    { name: "Gloss & Toner", price: "$65+", desc: "Restore shine and tone." },
                    { name: "Keratin Treatment", price: "$300+", desc: "Frizz reduction therapy." }
                ]
            }
        ];

        const DEFAULT_GALLERY = [
            "https://placehold.co/600x800/e2e2e2/999999?text=Portfolio+1",
            "https://placehold.co/600x800/e2e2e2/999999?text=Portfolio+2",
            "https://placehold.co/600x800/e2e2e2/999999?text=Portfolio+3"
        ];

        // --- CLOUD LOGIC ---
        const fetchCloudData = async () => {
            try {
                const response = await fetch(`${CLOUD_CONFIG.API_URL}/${CLOUD_CONFIG.BIN_ID}/latest`);
                const data = await response.json();
                return data.record;
            } catch (error) {
                console.error("Cloud fetch failed", error);
                return null;
            }
        };

        const saveToCloud = async (apiKey, data) => {
            try {
                const response = await fetch(`${CLOUD_CONFIG.API_URL}/${CLOUD_CONFIG.BIN_ID}`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json', 'X-Master-Key': apiKey },
                    body: JSON.stringify(data)
                });
                return response.ok;
            } catch (error) {
                console.error("Save failed", error);
                return false;
            }
        };

        // --- HELPER: DATE FORMATTING ---
        // Returns "YYYY-MM-DD" for easy comparison
        const getDateStr = (date) => {
            return date.getFullYear() + '-' + String(date.getMonth() + 1).padStart(2, '0') + '-' + String(date.getDate()).padStart(2, '0');
        };

        const getDaysInMonth = (year, month) => {
            const date = new Date(year, month, 1);
            const days = [];
            while (date.getMonth() === month) {
                days.push(new Date(date));
                date.setDate(date.getDate() + 1);
            }
            return days;
        };

        // --- COMPONENTS ---
        const Navbar = () => {
            const [scrolled, setScrolled] = useState(false);
            const [mobileMenuOpen, setMobileMenuOpen] = useState(false);
            useEffect(() => {
                const handleScroll = () => setScrolled(window.scrollY > 50);
                window.addEventListener('scroll', handleScroll);
                return () => window.removeEventListener('scroll', handleScroll);
            }, []);
            return (
                <nav className={`fixed w-full z-50 transition-all duration-300 ${scrolled ? 'bg-white shadow-md py-3' : 'bg-transparent py-5'}`}>
                    <div className="max-w-7xl mx-auto px-6 flex justify-between items-center">
                        <div className={`font-serif text-2xl font-bold tracking-widest ${scrolled ? 'text-gray-900' : 'text-white'}`}>da Linda</div>
                        <div className="hidden md:flex space-x-8">
                            {['Home', 'Services', 'Gallery', 'Book Now'].map((link) => (
                                <a key={link} href={`#${link === 'Home' ? 'hero' : link === 'Book Now' ? 'booking' : link.toLowerCase()}`} className={`text-sm tracking-wider hover:opacity-75 transition-colors ${scrolled ? 'text-gray-800' : 'text-white'}`}>{link.toUpperCase()}</a>
                            ))}
                        </div>
                        <button className={`md:hidden ${scrolled ? 'text-gray-900' : 'text-white'}`} onClick={() => setMobileMenuOpen(true)}><Icons.Menu /></button>
                    </div>
                    {mobileMenuOpen && (
                        <div className="fixed inset-0 bg-white z-50 flex flex-col items-center justify-center space-y-8 animate-fade-in">
                            <button className="absolute top-6 right-6 text-gray-800" onClick={() => setMobileMenuOpen(false)}><Icons.X /></button>
                            {['Home', 'Services', 'Gallery', 'Book Now'].map((link) => (
                                <a key={link} href={`#${link === 'Home' ? 'hero' : link === 'Book Now' ? 'booking' : link.toLowerCase()}`} className="text-2xl font-serif text-gray-900" onClick={() => setMobileMenuOpen(false)}>{link}</a>
                            ))}
                        </div>
                    )}
                </nav>
            );
        };

        const Hero = ({ isAdmin, heroText, setHeroText }) => (
            <section id="hero" className="relative h-screen w-full flex items-center justify-center overflow-hidden group">
                <div className="absolute inset-0 z-0">
                    <img src="https://images.unsplash.com/photo-1633681926022-84c23e8cb2d6?auto=format&fit=crop&q=80&w=2000" alt="Salon Interior" className="w-full h-full object-cover"/>
                    <div className="absolute inset-0 bg-black/40"></div>
                </div>
                <div className="relative z-10 text-center text-white px-4">
                    {isAdmin ? (
                        <div className="flex flex-col gap-4">
                            <input value={heroText.subtitle} onChange={(e) => setHeroText({...heroText, subtitle: e.target.value})} className="admin-input text-center text-black uppercase tracking-widest"/>
                            <input value={heroText.title} onChange={(e) => setHeroText({...heroText, title: e.target.value})} className="admin-input text-center text-black text-4xl font-serif"/>
                            <input value={heroText.tagline} onChange={(e) => setHeroText({...heroText, tagline: e.target.value})} className="admin-input text-center text-black italic"/>
                        </div>
                    ) : (
                        <>
                            <h2 className="text-sm md:text-base uppercase tracking-[0.3em] mb-4 opacity-90">{heroText.subtitle || "Welcome to"}</h2>
                            <h1 className="text-6xl md:text-8xl font-serif mb-6">{heroText.title || "da Linda"}</h1>
                            <p className="text-lg md:text-xl font-light italic opacity-90 mb-10">{heroText.tagline}</p>
                        </>
                    )}
                    <a href="#services" className="inline-block border border-white px-8 py-3 text-sm tracking-widest hover:bg-white hover:text-black transition-all duration-300 mt-8">EXPLORE SERVICES</a>
                </div>
            </section>
        );

        const Services = ({ isAdmin, services, setServices }) => {
            const updateService = (catIndex, itemIndex, field, value) => {
                const newServices = [...services];
                newServices[catIndex].items[itemIndex][field] = value;
                setServices(newServices);
            };

            const updateCategory = (catIndex, value) => {
                const newServices = [...services];
                newServices[catIndex].category = value;
                setServices(newServices);
            };

            const safeServices = Array.isArray(services) && services[0]?.category ? services : DEFAULT_SERVICES;

            return (
                <section id="services" className="py-20 bg-white">
                    <div className="max-w-4xl mx-auto px-6">
                        <div className="text-center mb-16">
                            <h2 className="text-4xl font-serif text-gray-900 mb-4">Our Menu</h2>
                            <div className="w-16 h-0.5 bg-[#D4AF37] mx-auto"></div>
                        </div>
                        
                        <div className="flex flex-col gap-12">
                            {safeServices.map((cat, catIdx) => (
                                <div key={catIdx}>
                                    {isAdmin ? 
                                        <input value={cat.category} onChange={(e) => updateCategory(catIdx, e.target.value)} className="admin-input font-serif text-2xl mb-6 font-bold text-[#D4AF37]" /> 
                                        : 
                                        <h3 className="text-2xl font-serif text-gray-800 mb-6 border-b border-gray-100 pb-2">{cat.category}</h3>
                                    }
                                    <div className="grid gap-6">
                                        {cat.items.map((item, itemIdx) => (
                                            <div key={itemIdx} className="flex flex-col md:flex-row justify-between items-start md:items-center group">
                                                <div className="md:w-3/4">
                                                    <div className="flex items-baseline">
                                                        {isAdmin ? 
                                                            <input value={item.name} onChange={(e)=>updateService(catIdx, itemIdx, 'name', e.target.value)} className="admin-input font-bold text-lg w-1/2"/> 
                                                            : 
                                                            <span className="font-bold text-lg text-gray-900">{item.name}</span>
                                                        }
                                                        {!isAdmin && <span className="mx-2 text-gray-300 flex-grow border-b border-dotted border-gray-300 h-1"></span>}
                                                    </div>
                                                    {isAdmin ? 
                                                        <input value={item.desc} onChange={(e)=>updateService(catIdx, itemIdx, 'desc', e.target.value)} className="admin-input text-xs text-gray-500 w-full"/> 
                                                        : 
                                                        <p className="text-xs text-gray-500 mt-1 uppercase tracking-wide">{item.desc}</p>
                                                    }
                                                </div>
                                                <div className="mt-1 md:mt-0">
                                                    {isAdmin ? 
                                                        <input value={item.price} onChange={(e)=>updateService(catIdx, itemIdx, 'price', e.target.value)} className="admin-input font-bold text-right"/> 
                                                        : 
                                                        <span className="text-lg font-serif text-[#D4AF37]">{item.price}</span>
                                                    }
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>
                </section>
            );
        };

        const GalleryCarousel = ({ isAdmin, images, setImages }) => {
            const [current, setCurrent] = useState(0);
            const safeImages = (images && images.length > 0) ? images : DEFAULT_GALLERY;
            const next = () => setCurrent((curr) => (curr + 1) % safeImages.length);
            const prev = () => setCurrent((curr) => (curr - 1 + safeImages.length) % safeImages.length);

            const addImage = () => {
                const url = prompt("Paste new Image URL (e.g., from an image host):");
                if (url) {
                    const newImages = [...safeImages, url];
                    setImages(newImages);
                    setCurrent(newImages.length - 1);
                }
            };
            const editImage = () => {
                const url = prompt("Edit this Image URL:", safeImages[current]);
                if (url) {
                    const newImages = [...safeImages];
                    newImages[current] = url;
                    setImages(newImages);
                }
            };
            const deleteImage = () => {
                if (safeImages.length <= 1) return alert("Cannot delete the last image.");
                if (confirm("Delete this photo?")) {
                    const newImages = safeImages.filter((_, i) => i !== current);
                    setImages(newImages);
                    setCurrent(0);
                }
            };

            return (
                <section id="gallery" className="py-20 bg-[#f9f9f7]">
                    <div className="max-w-7xl mx-auto px-6">
                        <div className="text-center mb-12">
                            <h2 className="text-4xl font-serif text-gray-900 mb-4">Portfolio</h2>
                            <div className="w-16 h-0.5 bg-[#D4AF37] mx-auto"></div>
                        </div>
                        <div className="max-w-2xl mx-auto relative group">
                            <div className="aspect-[3/4] md:aspect-[4/3] relative overflow-hidden rounded-lg shadow-xl bg-gray-